<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>رحلة سورة الكهف التفاعلية</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Naskh+Arabic:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Naskh Arabic', serif;
            direction: rtl;
            background-color: #f5f5f4;
            /* stone-100 */
            color: #292524;
            /* stone-900 */
        }

        .station-item {
            transition: background-color 0.3s ease;
            cursor: pointer;
        }

        .station-item:hover {
            background-color: #e7e5e4;
            /* stone-200 */
        }

        .thumn-highlight {
            border-right: 8px solid #065f46;
            /* emerald-700 */
            background-color: #dcfce7;
            /* emerald-100 */
            font-weight: bold;
            color: #065f46;
            /* emerald-700 */
        }

        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 50px;
            max-height: 50px;
        }

        .arabic-font {
            font-family: 'Noto Naskh Arabic', serif;
            line-height: 2.2;
            /* لراحة العين في قراءة النص القرآني */
        }
    </style>
</head>

<body class="p-6">
    <header class="text-center mb-10">
        <h1 class="text-5xl font-extrabold text-emerald-800 mb-4">رحلة سورة الكهف التفاعلية</h1>
        <p class="text-xl text-stone-600">اكتشف كنوز سورة الكهف آية بآية، مشهدًا بمشهد.</p>
    </header>

    <main class="grid grid-cols-1 md:grid-cols-3 gap-8">
        <aside class="md:col-span-1 bg-white p-6 rounded-lg shadow-xl h-[80vh] overflow-y-auto">
            <h2 class="text-2xl font-bold text-stone-800 mb-5 border-b-2 pb-3 border-stone-300">محطات الرحلة</h2>
            <div id="stations-list">
            </div>
        </aside>

        <section class="md:col-span-2">
            <div class="chart-container mb-8">
                <canvas id="progressChart"></canvas>
            </div>

            <div id="station-details" class="bg-white p-6 rounded-lg shadow-lg text-center mb-6">
                <h2 id="station-title" class="text-3xl font-bold text-emerald-700 mb-4"></h2>
                <p id="station-arabic-text" class="text-4xl font-bold text-stone-900 mb-4 arabic-font leading-relaxed">
                </p>
                <img id="station-image" src="" alt="صورة المحطة"
                    class="w-full h-auto rounded-lg mb-4 object-cover max-h-80">
                <p id="station-description" class="text-lg text-stone-700 mb-4"></p>
                <p id="transition-description"
                    class="text-xl text-emerald-800 font-semibold italic mb-6 border-b-2 border-emerald-300 pb-4"></p>
            </div>

            <div class="flex justify-between mt-4">
                <button id="prev-station"
                    class="bg-stone-600 text-white px-6 py-3 rounded-lg text-lg font-semibold hover:bg-stone-700 transition duration-300">المحطة
                    السابقة</button>
                <button id="next-station"
                    class="bg-emerald-600 text-white px-6 py-3 rounded-lg text-lg font-semibold hover:bg-emerald-700 transition duration-300">المحطة
                    التالية</button>
            </div>
        </section>
    </main>

    <footer class="text-center mt-10 text-stone-500 text-sm">
        <p>&copy; 2023 رحلة سورة الكهف التفاعلية. جميع الحقوق محفوظة.</p>
    </footer>

    <script>
        const stationsData = [
            {
                id: 1,
                title: "المحطة 1: بداية الرحلة والحمد",
                arabicText: "الْحَمْدُ لِلَّهِ الَّذِي أَنزَلَ عَلَىٰ عَبْدِهِ الْكِتَابَ وَلَمْ يَجْعَل لَّهُ عِوَجًا ۜ",
                description: "افتتاح السورة بالحمد لله الذي أنزل الكتاب على عبده محمد صلى الله عليه وسلم، وجعله مستقيمًا لا اعوجاج فيه.",
                image: "https://via.placeholder.com/600x300?text=بداية+الرحلة+والحمد",
                transitionDescription: "تتنفس بعمق، وتشعر بقلبك ينفتح على رحلة روحية جديدة. أمامك، تتجلى أولى صفحات سورة الكهف العظيمة، وكأنها بوابة لكونٍ آخر من التأمل واليقين. خطوتك الأولى نحو هذا النور المستقيم قد بدأت."
            },
            {
                id: 2,
                title: "المحطة 2: الإنذار والتبشير",
                arabicText: "قَيِّمًا لِّيُنذِرَ بَأْسًا شَدِيدًا مِّن لَّدُنْهُ وَيُبَشِّرَ الْمُؤْمِنِينَ الَّذِينَ يَعْمَلُونَ الصَّالِحَاتِ أَنَّ لَهُمْ أَجْرًا حَسَنًا",
                description: "القرآن قيم لينذر بالعذاب الشديد ويبشر المؤمنين العاملين الصالحات بالجزاء الحسن.",
                image: "https://via.placeholder.com/600x300?text=الإنذار+والتبشير",
                transitionDescription: "تنتقل خطوة واثقة، لتجد نفسك في مكانٍ يشع منه صوتٌ جهوري يحذر من بأسٍ شديدٍ آتٍ من عند الله، وفي نفس الوقت، تسمع نغماتٍ رقيقة تبشر المؤمنين العاملين بالصالحات بأجرٍ حسنٍ مقيم. كأنك ترى طريقين يتفرعان أمامك بوضوح."
            },
            {
                id: 3,
                title: "المحطة 3: جزاء المؤمنين الخالد",
                arabicText: "مَاكِثِينَ فِيهِ أَبَدًا",
                description: "بيان خلود المؤمنين في الأجر الحسن والنعيم المقيم.",
                image: "https://via.placeholder.com/600x300?text=الخلود+في+النعيم",
                transitionDescription: "تتخيل نفسك تتقدم نحو الأفق المشرق، حيث ترى صورًا للنعيم الأبدي. تشعر بسكونٍ عميق وأنت تدرك أن هذه الأرواح الطاهرة ستمكث هناك إلى الأبد. مشهد يملأ قلبك شوقًا ورجاءً بهذا المصير."
            },
            {
                id: 4,
                title: "المحطة 4: إنذار لمن قالوا اتخذ الله ولدًا",
                arabicText: "وَيُنذِرَ الَّذِينَ قَالُوا اتَّخَذَ اللَّهُ وَلَدًا",
                description: "إنذار شديد للذين زعموا أن لله ولدًا.",
                image: "https://via.placeholder.com/600x300?text=إنذار+التوحيد",
                transitionDescription: "يتغير المشهد فجأة، وتشعر بقوة الإنذار تتجه نحو أولئك الذين افتروا على عظمة الخالق. تسمع تحذيرًا مدويًا يتردد في الأجواء، وكأنك تشهد لحظة انكشاف الحق أمام الباطل المدعى."
            },
            {
                id: 5,
                title: "المحطة 5: جهل وافتراء",
                arabicText: "مَّا لَهُم بِهِ مِنْ عِلْمٍ وَلَا لِآبَائِهِمْ ۚ كَبُرَتْ كَلِمَةً تَخْرُجُ مِنْ أَفْوَاهِهِمْ ۚ إِن يَقُولُونَ إِلَّا كَذِبًا",
                description: "لا علم لهم ولا لآبائهم بهذا الافتراء، وهو قول عظيم وكذب مبين.",
                image: "https://via.placeholder.com/600x300?text=جهل+المفترين",
                transitionDescription: "تقترب أكثر، وتتضح لك الصورة أكثر: هؤلاء يتحدثون دون علم، كلماتهم ضخمة ولكنها فارغة من الحقيقة، مجرد كذب يخرج من أفواههم. تشعر بالأسى على جهلهم، وباليقين بعظمة الحقيقة الإلهية."
            },
            {
                id: 6,
                title: "المحطة 6: حيرة النبي (ص) وبداية القصة",
                arabicText: "فَلَعَلَّكَ بَاخِعٌ نَّفْسَكَ عَلَىٰ آثَارِهِمْ إِن لَّمْ يُؤْمِنُوا بِهَٰذَا الْحَدِيثِ أَسَفًا",
                description: "المقدمة لقصة أصحاب الكهف، وعتاب للنبي صلى الله عليه وسلم على شدة حرصه على إيمان قومه.",
                image: "https://via.placeholder.com/600x300?text=بداية+قصة+الكهف",
                transitionDescription: "تجد نفسك فجأة في حديقة، حيث ترى النبي الكريم (صلى الله عليه وسلم) وهو يأسف على قومه الذين لم يؤمنوا. تشعر بقلبه الشريف، وفي هذه اللحظة من التأمل العميق، يبدأ سرد قصة عجيبة ستأخذك إلى عالم آخر من العبر."
            },
            {
                id: 7,
                title: "المحطة 7: زينة الحياة الدنيا كاختبار",
                arabicText: "إِنَّا جَعَلْنَا مَا عَلَى الْأَرْضِ زِينَةً لَّهَا لِنَبْلُوَهُمْ أَيُّهُمْ أَحْسَنُ عَمَلًا",
                description: "زينة الأرض ومتاعها هي للابتلاء واختبار أعمال العباد.",
                image: "https://via.placeholder.com/600x300?text=زينة+الدنيا",
                transitionDescription: "تنتقل قدمك إلى مشهدٍ واسعٍ مليءٍ بزينة الحياة الدنيا. ترى الجبال والسهول، الأموال والأولاد، كلها تتلألأ أمام عينيك. لكنك تدرك أن هذا كله ليس سوى اختبار، وكأن عينك تبحث عن أجمل الأعمال لا عن أبهى المظاهر."
            },
            {
                id: 8,
                title: "المحطة 8: زوال زينة الدنيا",
                arabicText: "وَإِنَّا لَجَاعِلُونَ مَا عَلَيْهَا صَعِيدًا جُرُزًا",
                description: "أن كل ما على الأرض سيزول ويصير ترابًا لا نبات فيه.",
                image: "https://via.placeholder.com/600x300?text=زوال+الدنيا",
                transitionDescription: "ما إن تتأمل في زينة الدنيا حتى يتغير المشهد، فترى هذه الأرض المزينة تتحول تدريجياً إلى صعيدٍ قاحلٍ لا نبات فيه، ترابٌ جرز. شعورٌ بالزوال يغمرك، يدفعك للتفكير في ما هو باقٍ بعد الفناء."
            },
            {
                id: 9,
                title: "المحطة 9: هل تظن أن أصحاب الكهف آية عجيبة؟",
                arabicText: "أَمْ حَسِبْتَ أَنَّ أَصْحَابَ الْكَهْفِ وَالرَّقِيمِ كَانُوا مِنْ آيَاتِنَا عَجَبًا",
                description: "تنبيه إلى أن قصة أصحاب الكهف والرقيم ليست وحدها العجيبة من آيات الله، بل كل خلقه عجيب.",
                image: "https://via.placeholder.com/600x300?text=أصحاب+الكهف+والرقيم",
                transitionDescription: "بينما تسير، تسمع سؤالًا يتردد في ذهنك: هل تظن أن قصة هؤلاء الفتية في الكهف كانت أعجب آياتنا؟ هذا السؤال يفتح أمامك بابًا للتفكير في عظمة خلق الله كله، فكل شيء حولك آية عظيمة."
            },
            {
                id: 10,
                title: "المحطة 10: الفتية في الكهف",
                arabicText: "إِذْ أَوَى الْفِتْيَةُ إِلَى الْكَهْفِ فَقَالُوا رَبَّنَا آتِنَا مِن لَّدُنكَ رَحْمَةً وَهَيِّئْ لَنَا مِنْ أَمْرِنَا رَشَدًا",
                description: "لجوء الفتية المؤمنين إلى الكهف فرارًا بدينهم، ودعاؤهم لله بالرحمة والرشد.",
                image: "https://via.placeholder.com/600x300?text=الفتية+في+الكهف",
                transitionDescription: "تدخل الآن إلى مدخل كهفٍ مظلم، وتجد نفسك بجانب فتية مؤمنين فروا بدينهم. تسمع همسات دعائهم الصادق لله بأن يرزقهم رحمة ويهيئ لهم أمرهم رشدًا. تشعر بقوة إيمانهم وثباتهم رغم الخوف."
            },
            {
                id: 11,
                title: "المحطة 11: ضرب على آذانهم (نومهم)",
                arabicText: "فَضَرَبْنَا عَلَىٰ آذَانِهِمْ فِي الْكَهْفِ سِنِينَ عَدَدًا",
                description: "إنامة الله للفتية في الكهف لسنوات طويلة.",
                image: "https://via.placeholder.com/600x300?text=النوم+الطويل",
                transitionDescription: "ينسدل ستارة صمت عميق. ترى الفتية ينامون في الكهف، وكأن ضربة على آذانهم أخذت منهم الوعي، ليمضوا في سبات عميق لسنوات وسنوات. مشهد يثير الدهشة من قدرة الله على إحياء الموتى."
            },
            // ... (هنا يجب أن تستمر في إضافة بقية الآيات من سورة الكهف - الآيات من 12 إلى 64 قبل قصة موسى)
            // سأضع أمثلة لبعض المحطات الرئيسية في القصص الأخرى لترى كيف يمكن ربطها
            {
                id: 12,
                title: "المحطة 12: ثم بعثناهم",
                arabicText: "ثُمَّ بَعَثْنَاهُمْ لِنَعْلَمَ أَيُّ الْحِزْبَيْنِ أَحْصَىٰ لِمَا لَبِثُوا أَمَدًا",
                description: "إيقاظ الفتية بعد سباتهم الطويل لمعرفة أي الطائفتين أحصى لمدة لبثهم.",
                image: "https://via.placeholder.com/600x300?text=اليقظة+بعد+النوم",
                transitionDescription: "فجأة، تشعر بحركة خفيفة داخل الكهف. تستيقظ معهم، كأنك كنت نائمًا بجانبهم. تتساءل معهم عن المدة التي قضوها نائمين، وتدرك عظمة إحياء الله لهم بعد كل هذه السنين."
            },
            // ... (أكمل الآيات المتعلقة بقصة أصحاب الكهف إلى نهايتها)

            {
                id: 60, // مثال لآية قبل بداية قصة موسى والخضر
                title: "المحطة 60: قصة موسى والخضر (المقدمة)",
                arabicText: "وَإِذْ قَالَ مُوسَىٰ لِفَتَاهُ لَا أَبْرَحُ حَتَّىٰ أَبْلُغَ مَجْمَعَ الْبَحْرَيْنِ أَوْ أَمْضِيَ حُقُبًا",
                description: "بداية قصة موسى عليه السلام مع فتاه ورحلتهما للقاء الخضر.",
                image: "https://via.placeholder.com/600x300?text=موسى+والخضر",
                transitionDescription: "تنتقل رحلتك إلى مشهدٍ آخر تمامًا. تجد نفسك على شاطئ البحر، وتسمع موسى عليه السلام وهو يقطع العهد على نفسه بألا يبرح مكانه حتى يصل إلى ملتقى البحرين. تشعر بالترقب لرحلة العلم والمعرفة الغامضة التي ستبدأ."
            },
            {
                id: 61,
                title: "المحطة 61: فقدان الحوت",
                arabicText: "فَلَمَّا بَلَغَا مَجْمَعَ بَيْنِهِمَا نَسِيَا حُوتَهُمَا فَاتَّخَذَ سَبِيلَهُ فِي الْبَحْرِ سَرَبًا",
                description: "نسيان الحوت الذي كان علامة على مكان لقاء الخضر.",
                image: "https://via.placeholder.com/600x300?text=الحوت+والسرب",
                transitionDescription: "تتقدم مع موسى وفتاه على الشاطئ. فجأة، يغمرك شعور بأن شيئًا قد فُقد. ترى الماء ينشق، والحوت يتخذ سبيله فيه، وكأنك تشهد معجزة صامتة تحمل في طياتها سرًا كبيرًا."
            },
            {
                id: 62,
                title: "المحطة 62: تذكر الحوت",
                arabicText: "فَلَمَّا جَاوَزَا قَالَ لِفَتَاهُ آتِنَا غَدَاءَنَا لَقَدْ لَقِينَا مِن سَفَرِنَا هَٰذَا نَصَبًا",
                description: "بعد أن تجاوزا المكان، تذكر موسى الحوت وعلامة اللقاء.",
                image: "https://via.placeholder.com/600x300?text=تذكر+الحوت",
                transitionDescription: "وبعد أن تجاوزتم المكان، تسمع موسى وهو يطلب الغداء، ويشعر بالتعب من هذه الرحلة. في هذه اللحظة، يتذكر فتاه الحوت، ويخبره بالقصة. شعور بالاكتشاف يغمرك، فقد أدركت أنكم تجاوزتم الهدف."
            },
            {
                id: 63,
                title: "المحطة 63: مكان اللقاء",
                arabicText: "قَالَ أَرَأَيْتَ إِذْ أَوَيْنَا إِلَى الصَّخْرَةِ فَإِنِّي نَسِيتُ الْحُوتَ وَمَا أَنسَانِيهُ إِلَّا الشَّيْطَانُ أَنْ أَذْكُرَهُ ۚ وَاتَّخَذَ سَبِيلَهُ فِي الْبَحْرِ عَجَبًا",
                description: "إدراك فتى موسى أن مكان الصخرة هو مكان لقاء الخضر.",
                image: "https://via.placeholder.com/600x300?text=الصخرة+والعجب",
                transitionDescription: "تتجه قدمك إلى الصخرة التي كانت ملاذكما. ترى الحوت وهو يتخذ سبيله في البحر بعجب، وتدرك أن هذا هو المكان الموعود. شعور بالإثارة يمتزج بالفضول لما سيحدث بعد هذا اللقاء العجيب."
            },
            {
                id: 64,
                title: "المحطة 64: لقاء الخضر",
                arabicText: "قَالَ ذَٰلِكَ مَا كُنَّا نَبْغِ ۚ فَارْتَدَّا عَلَىٰ آثَارِهِمَا قَصَصًا",
                description: "فرحة موسى بوجود الخضر والعودة إلى مكان اللقاء.",
                image: "https://via.placeholder.com/600x300?text=لقاء+الخضر",
                transitionDescription: "تشعر بقلب موسى وهو يمتلئ بالفرح: 'ذلك ما كنا نبغي!' تتراجع معهما على نفس الآثار، والترقب يملأ الأجواء للقاء الرجل الصالح الذي سيفتح أبوابًا من العلم لم تكن لتعرفها."
            },
            {
                id: 65,
                title: "المحطة 65: العبد الصالح",
                arabicText: "فَوَجَدَا عَبْدًا مِّنْ عِبَادِنَا آتَيْنَاهُ رَحْمَةً مِّنْ عِندِنَا وَعَلَّمْنَاهُ مِن لَّدُنَّا عِلْمًا",
                description: "وصف الخضر بأنه عبد أوتي رحمة وعلماً من الله.",
                image: "https://via.placeholder.com/600x300?text=العبد+الصالح",
                transitionDescription: "وأخيرًا، تقع عيناك على العبد الصالح الذي أوتي رحمة وعلمًا من لدن الله. تشعر بهيبة حضوره، وتدرك أن هذه الرحلة ستمتلئ بالعبر التي تتجاوز فهمك الظاهر."
            },
            // ... (أكمل بقية قصة موسى والخضر حتى آية 82)

            {
                id: 83, // مثال لآية قبل بداية قصة ذي القرنين
                title: "المحطة 83: قصة ذي القرنين (المقدمة)",
                arabicText: "وَيَسْأَلُونَكَ عَن ذِي الْقَرْنَيْنِ ۖ قُلْ سَأَتْلُو عَلَيْكُم مِّنْهُ ذِكْرًا",
                description: "سؤال الناس عن ذي القرنين وبداية قصته.",
                image: "https://via.placeholder.com/600x300?text=ذي+القرنين",
                transitionDescription: "تنتقل فجأة إلى حقبة زمنية أخرى، وتسمع سؤالًا يتردد عن ملكٍ عظيم يُعرف بذي القرنين. تشعر بالفضول يملأك، وأنت تستعد لسماع قصة ملحمية عن القوة، والعدل، والرحلات العظيمة."
            },
            {
                id: 84,
                title: "المحطة 84: تمكين ذي القرنين",
                arabicText: "إِنَّا مَكَّنَّا لَهُ فِي الْأَرْضِ وَآتَيْنَاهُ مِن كُلِّ شَيْءٍ سَبَبًا",
                description: "تمكين الله لذي القرنين في الأرض وإعطائه الأسباب والقوة.",
                image: "https://via.placeholder.com/600x300?text=التمكين+والأسباب",
                transitionDescription: "ترى ذي القرنين وهو يسير في الأرض، وكأن القوة كلها بين يديه. تشعر بعظمة التمكين الإلهي، وكيف أن الله آتاه الأسباب ليسخرها في حكمه وعدله. مشهد يثير التأمل في أثر القوة الصالحة."
            },
            // ... (أكمل بقية قصة ذي القرنين حتى آية 98)

            {
                id: 99, // مثال لآية قبل بداية الحديث عن يوم القيامة
                title: "المحطة 99: يوم القيامة",
                arabicText: "وَتَرَكْنَا بَعْضَهُمْ يَوْمَئِذٍ يَمُوجُ فِي بَعْضٍ ۖ وَنُفِخَ فِي الصُّورِ فَجَمَعْنَاهُمْ جَمْعًا",
                description: "وصف ليوم القيامة واختلاط الناس وجمعهم بعد النفخ في الصور.",
                image: "https://via.placeholder.com/600x300?text=يوم+القيامة",
                transitionDescription: "تنتقل فجأة إلى مشهد مهيب. تسمع صوت النفخ في الصور، وترى البشر يموجون كأمواج البحر، يتجمعون للحساب. شعور بالرهبة يغمرك، تدرك أن هذه هي المحطة الكبرى التي لا فرار منها."
            },
            // ... (أكمل بقية الآيات حتى 109)

            {
                id: 110, // آخر آية في السورة
                title: "المحطة 110: خاتمة السورة والوصية الجامعة",
                arabicText: "قُلْ إِنَّمَا أَنَا بَشَرٌ مِّثْلُكُمْ يُوحَىٰ إِلَيَّ أَنَّمَا إِلَٰهُكُمْ إِلَٰهٌ وَاحِدٌ ۖ فَمَن كَانَ يَرْجُو لِقَاءَ رَبِّهِ فَلْيَعْمَلْ عَمَلًا صَالِحًا وَلَا يُشْرِكْ بِعِبَادَةِ رَبِّهِ أَحَدًا",
                description: "خاتمة السورة بالتوحيد والعمل الصالح، والتأكيد على بشرية النبي صلى الله عليه وسلم.",
                image: "https://via.placeholder.com/600x300?text=الخاتمة+والتوحيد",
                transitionDescription: "تصل إلى المحطة الأخيرة، حيث تتلخص كل العبر في هذه الآية الجامعة. تسمع الوصية الأخيرة بالتوحيد الخالص والعمل الصالح، وكأن كل ما سبق كان تمهيدًا لهذه الحقيقة العظيمة. تشعر بالسكينة وقد اكتملت رحلتك، ممتلئًا بالهداية والعلم."
            }
        ];

        let currentIndex = 0;
        let progressChartInstance;

        function renderStationsList() {
            const listContainer = document.getElementById('stations-list');
            listContainer.innerHTML = ''; // تنظيف القائمة
            stationsData.forEach((station, index) => {
                const stationItem = document.createElement('div');
                stationItem.classList.add('station-item', 'p-4', 'mb-2', 'rounded-lg', 'flex', 'items-center', 'space-x-3', 'bg-stone-50');
                if (index === currentIndex) {
                    stationItem.classList.add('thumn-highlight');
                }
                stationItem.innerHTML = `
                    <span class="text-xl font-bold text-emerald-800">${station.id}.</span>
                    <div>
                        <h3 class="text-lg font-semibold text-stone-800">${station.title}</h3>
                        <p class="text-sm text-stone-600">${station.arabicText.substring(0, 50)}...</p>
                    </div>
                `;
                stationItem.addEventListener('click', () => {
                    renderStation(index);
                });
                listContainer.appendChild(stationItem);
            });
        }

        function renderStation(index) {
            const station = stationsData[index];
            if (station) {
                document.getElementById('station-title').textContent = station.title;
                document.getElementById('station-arabic-text').textContent = station.arabicText;
                document.getElementById('station-description').textContent = station.description;
                document.getElementById('station-image').src = station.image;
                document.getElementById('transition-description').textContent = station.transitionDescription; // عرض الوصف الانتقالي

                currentIndex = index; // تحديث الـ currentIndex

                // تحديث الـ highlight في القائمة
                const items = document.querySelectorAll('.station-item');
                items.forEach((item, i) => {
                    if (i === index) {
                        item.classList.add('thumn-highlight');
                    } else {
                        item.classList.remove('thumn-highlight');
                    }
                });

                // تحديث مخطط التقدم
                updateProgressChart(index);

                // التمرير التلقائي للعنصر النشط
                const activeItem = document.querySelector('.station-item.thumn-highlight');
                if (activeItem) {
                    activeItem.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            }
        }

        function initProgressChart() {
            const ctx = document.getElementById('progressChart').getContext('2d');
            progressChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['التقدم'],
                    datasets: [{
                        label: 'المحطة الحالية',
                        data: [1], // يبدأ من المحطة 1
                        backgroundColor: '#065f46', // emerald-700
                        borderColor: '#047857', // emerald-800
                        borderWidth: 1
                    }]
                },
                options: {
                    indexAxis: 'y', // لجعل الشريط أفقيًا
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            beginAtZero: true,
                            max: stationsData.length, // الحد الأقصى هو عدد المحطات
                            ticks: {
                                stepSize: 1,
                                color: '#57534e', /* stone-600 */
                                font: { size: 12 }
                            },
                            grid: { display: false }
                        },
                        y: {
                            display: false,
                            grid: { display: false }
                        }
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            enabled: true,
                            rtl: true,
                            callbacks: {
                                label: function (context) {
                                    return ` المحطة: ${context.raw} من ${stationsData.length}`;
                                }
                            }
                        }
                    }
                }
            });
        }

        function updateProgressChart(currentIndex) {
            if (progressChartInstance) {
                progressChartInstance.data.datasets[0].data[0] = currentIndex + 1;
                progressChartInstance.update();
            }
        }

        // مستمعي الأحداث لأزرار التنقل
        document.getElementById('prev-station').addEventListener('click', () => {
            if (currentIndex > 0) {
                renderStation(currentIndex - 1);
            }
        });

        document.getElementById('next-station').addEventListener('click', () => {
            if (currentIndex < stationsData.length - 1) {
                renderStation(currentIndex + 1);
            }
        });

        // تهيئة عند تحميل الصفحة
        renderStationsList();
        initProgressChart();
        renderStation(currentIndex); // عرض المحطة الأولى عند التحميل
    </script>
</body>

</html>